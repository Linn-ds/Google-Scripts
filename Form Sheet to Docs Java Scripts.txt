function onOpen() {
  const ui = SpreadsheetApp.getUi();
  const menu = ui.createMenu('AutoFill Docs');
  menu.addItem('Create New Docs', 'createNewGoogleDocs')
  menu.addToUi();
  
}

function createNewGoogleDocs() {
  
  //This value should be the id of your document template that we created in the last step
  //Template fileကို Docs မှာ လုပ်ထားရမယ်။ Template ရဲ့ Id ကို https bar မှာ copy ယူရပြီး အောက်က Id ('ဒီမှာ')မှာဖြည့်
  
  const googleDocTemplate = DriveApp.getFileById('1owoZaaUJ_CWU4qtplwHc26Z7Z-C_beyjkTBfp_lujPY');
  
  //This value should be the id of the folder where you want your completed documents stored
  //ပြီးသွားတဲ့ doc file တွေ storeလုပ်ဖို့ folder ဆောက်ထားရမယ် Folder Id ကို copyပြီး အောက်က ('ဒီမှာ')မှာ paste လုပ်.
  
  const destinationFolder = DriveApp.getFolderById('1V7fr9KTXUApVpcA9ZO4dTln2yNbUvUn-')
  
  //Here we store the sheet as a variable 
  const sheet = SpreadsheetApp
    .getActiveSpreadsheet()
    .getSheetByName('Data')
//Sheet Fileထဲမှာ sheet page ဆိုတာရှိတယ် sheet page ရဲ့နာမည်ကိုဖြည့်။ (အောက်ခြေရဲ့ ဘယ်ဘက်ခြမ်းမှာတွေ့နိုင်) ကျနော််် ကDataလို့ပေးထားလို့ 
  
  //Now we get all of the values as a 2D array
  const rows = sheet.getDataRange().getValues();
  
  //Start processing each spreadsheet row  
  rows.forEach(function(row, index){
    //Here we check if this row is the headers, if so we skip it (header ပါရင် skip ဖို့code)
    if (index === 0) return;
    
    //Here we check if a document has already been generated by looking at 'Document Link', if so we skip it
    //Docs Link ချမဲ့ index ကိုဖြည့်ရန် ကျနော််  Link ထားမဲ့နေရာက 16 မှာဆို့တော့ 16 ထည့်ထားတာ
   //မှတ်ထားရမှာက programming မှာ index အရေအတွက်ကို ရေတွက်ရင် သုညကစရေတယ်။
    if (row[16]) return;
    
    //Using the row data in a template literal, we make a copy of our template document in our destinationFolder
    //နာမည်တပ်ဖို့ ကိုသတ်မှတ်ချင်တဲ့ နာမည်ကို sheet ထဲကနေ index နဲ့ သတ်မှတ်လို့ရတယ် 
    const copy = googleDocTemplate.makeCopy(`${row[2]}, ${row[7]} Employee Details` , destinationFolder)
    
    //Once we have the copy, we then open it using the DocumentApp
    const doc = DocumentApp.openById(copy.getId())
    
    //All of the content lives in the body, so we get that for editing
    const body = doc.getBody();
    
    //In this line we do some friendly date formatting, that may or may not work for you locale
    //မှတ်ထားရမှာက dateထည့်မယ်ဆို အောက်အကြောင်းက ' //' ကိုဖြုတ်ပြီးထည့်၊ index ထည့်။ body replace အောက်ဆုံးအကြောင်းကိုကြည့်
    // const friendlyDate = new Date(row[3]).toLocaleDateString(); 
    
    //In these lines, we replace our replacement tokens with values from our spreadsheet row
    //ကြိုက်သလောက်ထည့်လို့ရတယ် Templateမှာ နာမည်တွေပေးခဲ့တာတွေကို ရေးပြီး sheet က data ကိုထည့်မှာ၊ data ကို row Index နဲ့ ခေါ််တာ
    
    body.replaceText('{{Name}}', row[2]);
    body.replaceText('{{Why}}', row[9]);
    body.replaceText('{{Did}}', row[12]);   
    body.replaceText('{{Expect}}', row[13]);
    body.replaceText('{{Where}}', row[6]);
    body.replaceText('{{Age}}', row[5]);
    body.replaceText('{{ph}}', row[8]);
    body.replaceText('{{email}}', row[1]);
//body.replaceText('{{Hire Date}}', friendlyDate);
    
    //We make our changes permanent by saving and closing the document
    doc.saveAndClose();
    
    //Store the url of our new document in a variable
    const url = doc.getUrl();
    
    //Write that value back to the 'Document Link' column in the spreadsheet. 
    //columns counts ကိုဖြည့်ရမှာ
    sheet.getRange(index + 1, 17).setValue(url)
    
  })
  
}
